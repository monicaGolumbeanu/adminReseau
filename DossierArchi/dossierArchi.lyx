#LyX 1.6.7 created this file. For more info see http://www.lyx.org/
\lyxformat 345
\begin_document
\begin_header
\textclass article
\begin_preamble
\date{}
\end_preamble
\use_default_options true
\language french
\inputencoding auto
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family sfdefault
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\float_placement h
\paperfontsize 12
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_amsmath 1
\use_esint 1
\cite_engine basic
\use_bibtopic false
\paperorientation portrait
\leftmargin 2cm
\topmargin 2.5cm
\rightmargin 2cm
\bottommargin 2cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\author "" 
\author "" 
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box ovalbox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Title
Dossier Architecture
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center

\series bold
Auteurs:
\series default

\begin_inset Newline newline
\end_inset

Monica Golumbeanu, Billy Pitiot, Leandro Resende Mattioli, Stefana Gartu,
 Soraya Belhadj Aissa, Jérôme de potter
\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="4">
<features>
<column alignment="center" valignment="top" width="5cm">
<column alignment="center" valignment="top" width="4cm">
<column alignment="left" valignment="top" width="4cm">
<column alignment="left" valignment="top" width="3cm">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Référence
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Version
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Version du document
\end_layout

\end_inset

 1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Avancement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
☐ Validé
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dernière mise à jour
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
☐ Validé après modif.
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
☐ Revalidé
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features>
<column alignment="center" valignment="top" width="4cm">
<column alignment="center" valignment="top" width="4cm">
<column alignment="center" valignment="top" width="4cm">
<column alignment="center" valignment="top" width="4cm">
<row>
<cell multicolumn="1" alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none" width="4cm">
\begin_inset Text

\begin_layout Plain Layout
Visa
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Date
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Responsable
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Nom du responsable
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 0.5cm
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\lyxline

\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard

\lyxline

\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Le document présent constitue la réponse donnée par notre équipe de consultants
 à la demande de restructuration de l'architecture réseau de AIPRAO.
 Le dossier est structuré en deux parties.
 La première partie constitue un rapport décisionnel addressé à la Direction
 de l'AIP fournissant les informations nécessaires à sa décision de lancer
 le projet.
 La deuxième partie décrit une solution appropriée en proposant des prototypes
 réalisés en réponse aux différentes facettes du cahier des charges.
 Les annexes contiennent des éléments technologiques et organisationnels
 liés à l'organisation de l'environnement d'exploitation ainsi que des informati
ons pratiques utiles pour la configuration des équipements.
\end_layout

\begin_layout Section
Objectifs principaux pour la nouvelle architecture
\end_layout

\begin_layout Standard
La Direction de AIPRAO a donné un cadre définissant les objectifs pour l'évoluti
on de l'infrastructure:
\end_layout

\begin_layout Enumerate
L'architecture doit favoriser les regroupements de moyens
\end_layout

\begin_deeper
\begin_layout Standard
La Direction souhaite pouvoir mutualiser l'exploitation des systèmes industriels
 - le site central ou un autre site doit pouvoir héberger (d'une manière
 temporaire ou non) les ressources allouées usuellement à d'autres entités.
 Ainsi, une platforme industrielle virtuelle sera répartie entre des postes
 physiquement éloignées.
 L'objectif est la minimisation des transports pour les usagers.
\end_layout

\end_deeper
\begin_layout Enumerate
L'architecture doit permettre aux entités de bénéficier de services communs
 pour travailler à distance.
\end_layout

\begin_deeper
\begin_layout Standard
Des solutions de surveillance visuelle et de contrôle à distance doivent
 être mises en place tout en intégrant la protection des entités et de l'infrast
ructure globale.
\end_layout

\end_deeper
\begin_layout Enumerate
Optimisation et performance
\end_layout

\begin_deeper
\begin_layout Standard
La nouvelle architecture permettra de réduire les pertes de performance
 actuelles.
\end_layout

\end_deeper
\begin_layout Enumerate
Mobilité
\end_layout

\begin_deeper
\begin_layout Standard
Le déplacement d'équipement entre les sites doit être possible et facile
 à réaliser avec un minimum d'opérations simples de configuration.
\end_layout

\end_deeper
\begin_layout Enumerate
Evolutivité
\end_layout

\begin_deeper
\begin_layout Standard
L'ajout de tout matériel nouveau (serveur, platine, machine, etc.) doit être
 possible et facile à réaliser.
\end_layout

\end_deeper
\begin_layout Enumerate
Securité
\end_layout

\begin_deeper
\begin_layout Standard
La surveillance de tout le système doit être possible.
 Par conséquent, un système d'administration doit être mis en place.
\end_layout

\end_deeper
\begin_layout Section
Organisation de l'architecture
\end_layout

\begin_layout Standard
Les parties qui suivent contiennent la proposition d'architecture qui répond
 aux demandes du client.
 Tous les choix sont argumentés.
\end_layout

\begin_layout Subsection
Description générale
\end_layout

\begin_layout Standard
L'architecture deployée sur les trois sites (AIP, GE, Roanne) est présentée
 dans la figure suivante.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename archi.png
	scale 45

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Organisation du réseau sur trois sites
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La liaison entre les différents sites est réalisée par des tunnels VPN qui
 offrent un accès sécurisé ainsi qu'un service d'authentification efficace
 pour les différents utilisateurs accédant aux plateformes industrielles
 (voir Figure 2).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename connexionVPN.png
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Liaison par VPN entre les sites
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Le routeur S@N sera utilisé pour interconnecter des différentes sites.
 Chaque site pourra avoi plusieurs connexion VPN en parallèle.
 Un VPN global sera créé qui permettra le partage des ressources en toute
 securité.
\end_layout

\begin_layout Standard
Un utilisateur externe (étudiant, professeur, etc.) pourra se connecter à
 tout moment par VPN depuis l'extérieur et avoir ainsi accès aux ressources
 hebergées par le site auquel il s'est connecté.
\end_layout

\begin_layout Standard
Dans chaque site deux VLANs ont été mis en place.
 Le premier ne contient que le matériel industriel (les plaques avec les
 automates) et l'autre contient le reste.
 La configuration realisée permet de mettre en place plusieurs VLANs si
 on désire.
 
\end_layout

\begin_layout Standard
Le fait d'avoir reservé un VLAN spécialement pour l'équipement industriel
 permet facilement d'avoir un cloisonnement des données.
 En effet, le broadcast réalisé par les automates restera dans le VLAN et
 n'influencera pas le reste.
\end_layout

\begin_layout Standard
Chaque site possède un serveur DHCP et un serveur DNS.
 Le serveur DHCP s'occupera d'associer des adresses IP en utilisant des
 DHCP relais entre les différents réseaux tandis que le serveur DNS gérera
 le nommage.
 Les politiques de nommage et d'addressage seront détaillées dans les sections
 qui suivent.
\end_layout

\begin_layout Standard
Les configurations entre les sites seront partagées par l'intermédiaire
 d'un système de monitoring.
\end_layout

\begin_layout Subsection
Argumentation
\end_layout

\begin_layout Standard
La partie qui suit décrit comment la solution proposée peut répondre à la
 demande du client et atteindre les objectifs proposés.
\end_layout

\begin_layout Enumerate
L'architecture doit favoriser les regroupements de moyens
\end_layout

\begin_deeper
\begin_layout Standard
Ceci est possible grâce à l'architecture VLAN proposée.
 Supposant qu'on veut mettre ensemble deux équipements physiquement éloignés,
 c'est possible en les mettant dans le même VLAN et donc dans le même sous
 réseau.
 Cette opération est possible via une interface web et ne nécessite pas
 d'actions physiques (branchement, débranchement, etc.).
\end_layout

\end_deeper
\begin_layout Enumerate
L'architecture doit permettre aux entités de bénéficier de services communs
 pour travailler à distance
\end_layout

\begin_deeper
\begin_layout Standard
Comme chaque plateforme intègre un serveur HTTP, il sera possible de se
 connecter de n'importe quelle poste possedant accès Internet par l'intérmediair
e d'un navigateur web sur un des sites (AIP, GE, Roanne, ...).
 L'accès aux plaques industrielles sera donc assuré via une interface web.
 
\begin_inset Newline newline
\end_inset

L'accès nécessite une authentification par VPN qui assure une connexion
 securisée.
\end_layout

\end_deeper
\begin_layout Enumerate
Optimisation et performance
\end_layout

\begin_deeper
\begin_layout Standard
Le découpage en VLANs permet le cloisonnement des données et apporte un
 plus des performances et d'optimisation à l'architecture.
 Le traffic des paquets broadcast est gardé à l'intérieur des VLANs spécialement
 crées ce qui allège le traffic global et augmente les performances.
\end_layout

\end_deeper
\begin_layout Enumerate
Mobilité
\end_layout

\begin_deeper
\begin_layout Standard
Les politiques de nommage et d'adressage proposées rendent possible le déplaceme
nt et l'installation facile d'équipement entre les sites.
 Ces deux politiques sont détaillées dans les parties qui vont suivre.
\end_layout

\end_deeper
\begin_layout Enumerate
Evolutivité
\end_layout

\begin_deeper
\begin_layout Standard
L'organisation en VLANs et la politique de nommage rendent facile l'ajout
 de tout matériel ou toute augmentation physique du réseau.
\end_layout

\end_deeper
\begin_layout Enumerate
Securité
\end_layout

\begin_deeper
\begin_layout Standard
Des caméras de surveillance seront installées et pourront être suivies depuis
 une machine.
 Chaque site contient un serveur qui centralise les enregistrements vidéo.
 A tout moment un superviseur pourra se connecter au serveur vidéo et consulter
 les caméras de vidéosurveillance.
\end_layout

\end_deeper
\begin_layout Subsection
Description détaillée
\end_layout

\begin_layout Standard
Cette section comprend la description détaillée de chaque équipement utilisé
 dans l'architecture.
\end_layout

\begin_layout Subsubsection
Routeurs Firewall VPN
\end_layout

\begin_layout Standard
Ces elements sont destinés à transporter les messages à l'intérieur des
 sous-réseaux.
 Comme une règle de base de sécurité, on utilise des firewalls pour mieux
 protéger ces réseaux.
\end_layout

\begin_layout Standard
De plus, le réseaux virtuel permet d'avoir un réseau logique qui intègre
 tous les campus et un accès distant sécurisé.
\end_layout

\begin_layout Standard
Le routeur choisi est le 
\emph on
VPN S@N 2000
\emph default
 (4 ports Ethernet 10/100Mbits, 128 tunnels VPN en parallel).
\end_layout

\begin_layout Subsubsection*
Configuration
\end_layout

\begin_layout Itemize

\series bold
Firewall
\series default
 
\end_layout

\begin_deeper
\begin_layout Itemize
bloquer toutes les requêtes venant de l'exterieur
\end_layout

\begin_layout Itemize
redirection de port vers le S@N.
\end_layout

\begin_layout Itemize
gerer des profils de permissions pour les postes connectés via VPN, ayant
 comme permission minimale l'authorisation de la connexion au serveur HTTP
 seulement.
 
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Service DHCP:
\series default
 desactivé, vu que un serveur dedié sera mis en place.
\end_layout

\begin_layout Itemize

\series bold
VPN
\end_layout

\begin_deeper
\begin_layout Itemize
la connexion est effectuée par l'adresse IP du routeur du campus et le port
 associé à cette redirection
\end_layout

\begin_layout Itemize
2 tunnels permanents seront établis, pour pouvoir connecter aux deux autres
 S@N
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Du au plan de nommage effectué voir section YY, la juxtaposition des 3 réseaux
 est assez simple.
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
permettre les connexions depuis un client VPN (rendre possible l'accès distant).
\end_layout

\end_deeper
\begin_layout Subsubsection
Switches
\end_layout

\begin_layout Standard
Les switches seront utilisés pour:
\end_layout

\begin_layout Itemize
interconnecter les élements d'une certaine plaque
\end_layout

\begin_layout Itemize
interconnecter les serveurs et postes supervision
\end_layout

\begin_layout Itemize
interconnecter l'ensemble des plaques
\end_layout

\begin_layout Itemize
segmenter le réseau VPN, par l'utilisation de VLANS
\end_layout

\begin_layout Standard
Les switches choisis sont:
\end_layout

\begin_layout Itemize

\series bold
TCM ESM 163F23F0:
\series default
 16 ports, VLAN Niveau 3, 10/100 Mbits.
 
\emph on
Utilisé pour interconnecter les plaques
\end_layout

\begin_layout Itemize

\series bold
499 NES 181 00:
\series default
 8 ports, 10/100 Mbits.
 
\emph on
Utilisé à l'intérieur d'une plaque et aussi pour interconnecter les serveurs
 et le poste supervision.
\end_layout

\begin_layout Standard
La division en VLANs se fera selon les critères suivants:
\end_layout

\begin_layout Itemize
un VLAN pour la manipulation.
\end_layout

\begin_layout Itemize
un VLAN pour les serveurs et le poste de supervision.
\end_layout

\begin_layout Subsubsection
Serveurs DHCP, DNS et HTTP
\end_layout

\begin_layout Standard
Des serveurs DHCP et DNS dédiés seront mises en place.
 Leurs objectifs, sont, respectivement, l'adressage dynamique (et alors
 une configuration plus simple) et l'attribution de noms aux machines.
 
\end_layout

\begin_layout Standard
Le serveur HTTP devra fournir une interface Web pour la surveillance des
 plateformes et équipements industrielles.
 Pour raisons de sécurité, il ne sera pas accessible depuis l'exterieur
 sauf par connexion VPN.
 Chaque site aura son serveur HTTP, ce qui apporte une bon efficacité par
 rapport aux temps de réponse.
 
\end_layout

\begin_layout Standard
Pour économiser les coûts avec des logiciels, on propose d'utiliser le système
 d'exploitation orienté serveur 
\emph on
Ubuntu Server
\emph default
, et le configurer avec les paquets suivants:
\end_layout

\begin_layout Itemize
Pour le serveur DHCP:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
isc-dhcp-server:
\series default
 serveur DHCP implementé par le ICS (Internet Software Consortium)
\end_layout

\end_deeper
\begin_layout Itemize
Pour le serveur DNS:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
bind9:
\series default
 le serveur BIND (Berkeley Internet Name Domain) est le serveur DNS le plus
 connu et utilisé, et en plus supporté par le ICS.
\end_layout

\end_deeper
\begin_layout Itemize
Pour le serveur HTTP, les logiciels mises en place dependent des technologies
 de développement envisagés.
 Quelques logiciels associés (tous disponibles sur le système proposé) sont:
\end_layout

\begin_deeper
\begin_layout Itemize
Apache 2
\end_layout

\begin_layout Itemize
PHP 5
\end_layout

\begin_layout Itemize
Ruby on Rails
\end_layout

\begin_layout Itemize
Django
\end_layout

\begin_layout Itemize
Glassfish
\end_layout

\begin_layout Itemize
Mono
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
plateforme .NET disponible sur des systèmes GNU/Linux avec support à serveurs
 Web ASP.NET
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Pour tous les serveurs:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
openssh-server:
\series default
 Pour permettre l'accès et la configuration à distance des serveurs.
\end_layout

\end_deeper
\begin_layout Section
Gestion du nommage et de l'adressage
\end_layout

\begin_layout Standard
Le nommage des machines est indispensable pour une lecture facile par l'œil
 humain et surtout pour une mémorisation et une utilisation plus intuitive
 qu'une adresse IP.
 Nous avons donc choisi une politique de nommage qui uniformisera la méthode
 de nommage des différentes machines sur le réseau.
\end_layout

\begin_layout Standard
Le nom d'une machine sera composé de plusieurs champs distincts.
 Chacun de ces champs se retrouve dans l'adresse IP, ce qui permet d'associer
 facilement une adresse à une machine.
 Ces champs sont les suivants :
\end_layout

\begin_layout Itemize
Identifiant du lieu où se trouve la machine.
\end_layout

\begin_deeper
\begin_layout Standard
Exemple : lyon_aip ==> IP correspondante : 10.0.X.X
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.6cm
\end_inset

lyon_ge ==> IP correspondante : 10.1.X.X
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.6cm
\end_inset

roanne_tp1 ==> IP correspondante : 10.2.X.X
\end_layout

\end_deeper
\begin_layout Itemize
Type de l'équipement
\end_layout

\begin_deeper
\begin_layout Standard
Exemple : Routeur ==> IP correspondante : 10.X.0.1 dans VLAN1/ 10.X.1.1 dans VLAN2
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.9cm
\end_inset

Serveur DNS ==> IP correspondante : 10.X.0.4
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.9cm
\end_inset

Serveur données Windows ==> IP correspondante : 10.X.0.3
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.9cm
\end_inset

Serveur DHCP ==> IP correspondante : 10.X.0.5
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.9cm
\end_inset

Poste Supervision ==> IP correspondante : 10.X.0.6
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.9cm
\end_inset

Plaque_1_automate_1 ==> IP correspondante : 10.X.1.5
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.9cm
\end_inset

Plaque_1_automate_2 ==> IP correspondante : 10.X.1.6
\end_layout

\begin_layout Standard
\begin_inset space \hspace{}
\length 1.9cm
\end_inset

Plaque_2_automate_N ==> IP correspondante : 10.X.1.2*5+(N-1) = 10.X.1.10+(N-1).
\end_layout

\end_deeper
\begin_layout Standard
Au final nous aurons des équipements avec des noms ressemblant à celui-là
 : lyon_aip_plaque_1_automate_1.
\end_layout

\begin_layout Standard
L'adresse IP correspondante est : 10.0.1.5
\end_layout

\begin_layout Standard
On a choisi, dans chaque site, de créer un VLAN qui ne regroupe que l'équipement
 industriel (disons VLAN1) et un autre VLAN qui contient le reste du matériel
 (serveurs, postes, etc.
 - VLAN2).
 Cette distinction est visible au niveau des adresses IP, au niveau du troisième
 octet.
 Ainsi, les adresses des équipements industriels sont sous la forme 10.X.1.X
 tandis que les adresses des machines du VLAN2 son sous la forme 10.X.0.X.
\end_layout

\begin_layout Standard
L'adresse du VLAN1 sera 10.X.1.0 tandis que celle du VLAN2 sera 10.X.0.0.
 X diffère en fonction du site (0 pour AIP, 1 pour GE, 2 pour Roanne, etc.).
\end_layout

\begin_layout Standard
Les adresses des automates sur des plaques seront calculés d'après la formule
 suivante: 10.X.1.5*N°Plaque+(N°Automate-1).
 On modifie donc le quatrième octet.
 Par exemple, l'addresse de l'automate 3 situé sur la plaque 4 sur le site
 AIP sera 10.0.1.22.
\end_layout

\begin_layout Standard
Chaque site contient un routeur qui aura deux adresses différentes (une
 pour VLAN1 et une dans VLAN2).
 Dans VLAN1(équipement industriel) l'adresse est 10.X.1.1 et dans VLAN2 (équipement
 normal) est 10.X.0.1.
 Les routeurs utiliseront la méthode NAT pour la translation d'addresses.
\end_layout

\begin_layout Standard
La méthode mise en place permet une facilité de lecture et surtout de mise
 à jour en cas de déplacement d'une plaque : il suffit de mettre à jour
 le lieu dans lequel elle se trouve dans son nom et de changer les octets
 correspondants de l'adresse IP.
\end_layout

\begin_layout Standard
Pour avoir une idée globale du plan d'adressage, l'Annexe 0 fournit le plan
 complet, y inclut les masques des sous réseaux.
\end_layout

\begin_layout Standard
En conclusion, les adresses dans le réseau seront de la forme 10.X.Y.Z où:
\end_layout

\begin_layout Itemize
X est spécifique pour le site (0 pour AIP, 1 pour GE, 2 pour Roanne)
\end_layout

\begin_layout Itemize
Y est spécifique au type d'appareil (1 pour industriel - VLAN1, 0 pour normal
 - VLAN2)
\end_layout

\begin_layout Itemize
Z est spécifique à un automate sur une palque (5*N°Plaque+(N°Automate-1))
\end_layout

\begin_layout Section
Système d'administration
\end_layout

\begin_layout Subsection
Comparaison des solutions logicielles
\end_layout

\begin_layout Standard
Identification des critères de comparaison : Nous avons choisi une liste
 de critères qui serviront à déterminer notre choix entre les deux solutions
 logicielles Nagios couplé à MRTG et HiVison de Hirschmann et nous avons
 effectué un tableau comparatif entre ces deux solutions.
 Voici donc nos critères de comparaison :
\end_layout

\begin_layout Itemize
L’investissement initial (coût d’achat et coût d’installation)
\end_layout

\begin_layout Itemize
Coût en phase de production
\end_layout

\begin_layout Itemize
Critères techniques et performances
\end_layout

\begin_layout Itemize
Gestion des problèmes
\end_layout

\begin_layout Itemize
Statistiques
\end_layout

\begin_layout Itemize
Le confort d’utilisation et accessibilité
\end_layout

\begin_layout Itemize
Documentation et support
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features>
<column alignment="center" valignment="top" width="9cm">
<column alignment="center" valignment="top" width="5cm">
<column alignment="center" valignment="top" width="3.8cm">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Critères
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nagios/MRTG
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hirschmann/HiVision
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Investissement initial
\end_layout

\begin_layout Plain Layout
Coût d'achat
\end_layout

\begin_layout Plain Layout
Coût d'installation et de configuration initiale
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Gratuit
\end_layout

\begin_layout Plain Layout
élevé
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
10 000 euros
\end_layout

\begin_layout Plain Layout
faible
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Coût en phase de production
\end_layout

\begin_layout Plain Layout
Coût de la licence par an
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Gratuite
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Critères techniques et performances
\end_layout

\begin_layout Plain Layout
plugins existants
\end_layout

\begin_layout Plain Layout
possibilité et coût d'ajout de plugins
\end_layout

\begin_layout Plain Layout
Accord en partenariat avec des entreprises
\end_layout

\begin_layout Plain Layout
Gestion des MIB
\end_layout

\begin_layout Plain Layout
Scan réseau par critères
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Coût de développement
\end_layout

\begin_layout Plain Layout
Non
\end_layout

\begin_layout Plain Layout
Non
\end_layout

\begin_layout Plain Layout
Non
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Coût d’achat
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Gestion de problèmes
\end_layout

\begin_layout Plain Layout
Existence d'alertes
\end_layout

\begin_layout Plain Layout
pilotage d'alertes par escalade
\end_layout

\begin_layout Plain Layout
gestion d'erreurs par niveau
\end_layout

\begin_layout Plain Layout
assistance dans la gestion des erreurs
\end_layout

\begin_layout Plain Layout
gestion d'erreurs en définissant les liens entre les différents composants
 réseaux
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Non 
\end_layout

\begin_layout Plain Layout
Non
\end_layout

\begin_layout Plain Layout
Non
\end_layout

\begin_layout Plain Layout
Non
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Oui 
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Statistiques
\end_layout

\begin_layout Plain Layout
statistiques d'erreurs
\end_layout

\begin_layout Plain Layout
statistiques de traffic
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Confort d'utilisation et accessibilité
\end_layout

\begin_layout Plain Layout
monitoring à distance
\end_layout

\begin_layout Plain Layout
monitoring par ligne téléphonique
\end_layout

\begin_layout Plain Layout
monopolisation d'une ressource humaine 24h/24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Non
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Plain Layout
Oui 
\end_layout

\begin_layout Plain Layout
Oui
\end_layout

\begin_layout Plain Layout
Non
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Documentation et support
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Faible
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bonne
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Etant donné que Nagios/MRTG est une solution open source, elle présente
 entre autres les défauts de n’importe quelle solution similaire.
 La solution n’est pas très bien documentée.
 Elle favorise la performance à l’utilisation et la commercialisation et
 donc au confort et à l’accessibilité.
 N’ayant pas de périmètre de fonctionnalités bien défini, nous ne pouvons
 pas juger de l’application de ces fonctionnalités dès le départ et il nous
 faudra donc une solution assez évolutive dans un temps court.
 Ceci n’est pas possible avec la première solution car une solution qui
 est non disponible doit être développée par nous étant limité en temps
 et en argent.
 Nagios nous présente une interface web assez simple, très riche en informations
 que nous pensons est adéquate dans notre cas d’utilisation de supervision
 d’une configuration relativement inchangée.
 Par contre cette interface ne nous permet pas de surmonter la configuration
 compliquée à la mise en œuvre du système d’administration ainsi qu’aux
 changements dans la topologie du réseau.
 Nous choisirons donc la solution payante HiVision-Hirschmann en vue de
 sa notoriété sur le marché.
\end_layout

\begin_layout Subsection
Manuel de dépannage
\end_layout

\begin_layout Subsubsection
Procédure sans intervention d'un technicien
\end_layout

\begin_layout Standard
Lorqu'une erreur ou anomalie est constatée, le personnel en charge de la
 surveillance du réseau doit dans un premier temps se référer au manuel
 de dépannage.
 Ce manuel permet de guider l'utilisateur en fonction de ce qu'il constate
 sur le terrain.
 Une fois l'erreur identifiée, il cherche dans le manuel les solutions proposées.
 
\end_layout

\begin_layout Standard
Après avoir effectué les opérations proposées, si le problème est résolu,
 il consigne l'erreur dans un journal ainsi que les manipulations effectuées
 qui ont conduit à sa résolution.
 
\end_layout

\begin_layout Standard
Si le problème n'est pas résolu, le manuel demande plus de détails à l'utilisate
ur et notamment le résultat des manipulations effectuées.
 Il propose alors à l'utilisateur de nouvelles manipulations plus ciblées.
 Et ainsi de suite jusqu'à résolution du problème.
\end_layout

\begin_layout Standard
Le manuel propose ainsi des actions de plus en plus ciblées à l'utilisateur
 pour résoudre le problème.
 Cependant, ces actions bien que ciblées sont simples et ne nécessite aucune
 connaissance avancée en supervision de réseau.
\end_layout

\begin_layout Subsubsection
Procédure avec intervention d'un technicien
\end_layout

\begin_layout Standard
Si les manipulations du manuel ne suffisent pas, celui-ci invite l'utilisateur
 à contacter un techicien.
 Le manuel sauvegarde les manipulations effectuées par le superviseur et
 ainsi le technicien à la possibilité de les connaître.
 Ces informations lui permettront d'effectuer une intervention plus rapidement.
\end_layout

\begin_layout Standard
Une fois l'intervention terminée, le technicien consigne l'erreur dans le
 journal ainsi que les manipulations effectuées par le superviseur et par
 lui même.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
Annexes
\end_layout

\begin_layout Subsection
Annexe 0 - Schéma architecture 
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename archi.png
	lyxscale 20
	scale 52
	rotateAngle 90

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Subsection
Annexe 1 - Gestion du DNS et du DHCP
\end_layout

\begin_layout Subsubsection
Configurations possibles
\end_layout

\begin_layout Standard
Les paramètres obtenus pour la commande 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

set all
\end_layout

\end_inset

 sont présentés dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cmd_set_all"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/nslookup_linux.png
	scale 34

\end_inset


\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/nslookup_windows.png
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:cmd_set_all"

\end_inset

 Commande 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

set all
\end_layout

\end_inset

 de 
\noun on
nslookup
\noun default
 dans les environnements 
\noun on
Windows
\noun default
 et 
\noun on
GNU/Linux
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Une description succinte de quelques paramètres est donnée ci-dessous :
\end_layout

\begin_layout Standard
\begin_inset Box ovalbox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Description
\begin_inset VSpace smallskip
\end_inset


\end_layout

\begin_layout Description
root Serveur pour la racine du domaine (
\emph on
A.ROOT-SERVERS.NET
\emph default
).
\end_layout

\begin_layout Description
domain Domaine de nom concerné (
\emph on
insa-lyon.fr
\emph default
).
\end_layout

\begin_layout Description
port Port utilisé pour le serveur de domaine (53).
\end_layout

\begin_layout Description
type Type de la requête DNS (
\emph on
type A
\emph default
).
\end_layout

\begin_layout Description
retry Nombre de tentatives de la requête (
\emph on
une seul tentative
\emph default
).
\end_layout

\begin_layout Description
timeout Durée d'une requête avant son expiration (
\emph on
2 secondes
\emph default
).
\end_layout

\begin_layout Description
class Code de la classe de l'enregistrement DNS (
\emph on
IN -- Internet
\emph default
).
\end_layout

\begin_layout Description
defname Ajouter le nom du domaine par défaut à des requêtes simples (qui
 ne contiennent pas de période).
\end_layout

\begin_layout Description
recurse Demander à autres serveurs si on n'a pas l'information.
\end_layout

\begin_layout Description
srchlist Liste des domaines utilisés par le paramètre 
\emph on
search
\emph default
.
 Le domaine défini par une commande 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

set domain
\end_layout

\end_inset

 sera remplacé par le premier item de la liste.
 (
\emph on
insa-lyon.fr
\emph default
).
\end_layout

\begin_layout Description
search Cette option ajoute les domaines stockés par le paramètre 
\emph on
srchlist
\emph default
 à la requête jusqu'à réception d'une réponse, sauf si la requête est finie
 par une période (.).
\end_layout

\begin_layout Description
novc Ne pas utiliser un circuit virtuel.
\end_layout

\begin_layout Description
nodebug Sans information de debogage.
\end_layout

\begin_layout Description
\begin_inset VSpace smallskip
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Résolution du nom 
\noun on
servif-baie
\end_layout

\begin_layout Standard
La figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:servifbaie"

\end_inset

 montre le résultat de la commande.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/servifbaie_linux.png
	lyxscale 30
	scale 34

\end_inset


\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/servifbaie_windows.png
	lyxscale 30
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:servifbaie"

\end_inset

 Résolution de la machine 
\noun on
servif-baie
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Il n'y a pas besoin du nom complet (avec le nom du domaine inclus) à cause
 des paramètres 
\noun on
defname
\noun default
 et 
\noun on
domain
\noun default
, vus dans la section précedent.
 Avec un nom de domaine défini et la option defname activé, les requêtes
 d'un seul element (requêtes sans periode) sont automatiquement completées.
 L'adresse de 
\noun on
servif-baie
\noun default
 est 134.214.104.22 et le type d'enregistrement utilisé est le type A (un IPv4,
 4 octets).
\end_layout

\begin_layout Subsubsection
Résolution du mail
\end_layout

\begin_layout Standard
La résolution de la machine 
\noun on
mail
\noun default
 est montré dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:mail"

\end_inset

.
 Son nom est 
\noun on
mail.insa-lyon.fr
\noun default
 (alias pour 
\noun on
dsi04.insa-lyon.fr
\noun default
).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/mail_linux.png
	lyxscale 40
	scale 34

\end_inset


\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/mail_windows.png
	lyxscale 40
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:mail"

\end_inset

 Résolution de 
\noun on
mail
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Pour obtenir l'adresse du serveur de mail de 
\noun on
Lyon 1
\noun default
, on peut changer le type de la requête DNS, avec la commande 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

set type=mx
\end_layout

\end_inset

 (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:univlyon1"

\end_inset

).
 Avec cette commande, on peut trouver les serveur 
\noun on
mail
\noun default
 liés à un certain domaine.
 Le serveur de mail de Lyon 1 est, donc, 
\noun on
smtpbv.univ-lyyon1.fr
\noun default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/univlyon1_linux.png
	lyxscale 75
	scale 34

\end_inset


\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/univlyon1_windows.png
	lyxscale 75
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:univlyon1"

\end_inset

 Résolution de 
\noun on
univ-lyon1
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Vu qu'il existe seulement un serveur, la valeur de la préference (dans ce
 cas, 5) n'est pas utile.
 Par contre, on peut voir qu'il existe une répartition de charge entre 4
 machines (134.214.128.75 ...
 134.214.128.77).
 
\end_layout

\begin_layout Subsubsection
Obtention du nom de 134.214.61.235
\end_layout

\begin_layout Standard
Comme montré dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:obtention_nom_machine"

\end_inset

, la machine 134.214.61.235 a comme nom 
\noun on
if-4207.insa-lyon.fr
\noun default
 et le type d'enregistrement utilisé est le type A.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/trouvermachine_linux.png
	lyxscale 30
	scale 34

\end_inset


\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/trouvermachine_windows.png
	lyxscale 30
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:obtention_nom_machine"

\end_inset

 Obtention du nom de 134.214.61.135
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Résolution du host 
\noun on
www.google.fr
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/resoudregoogle_linux.png
	lyxscale 30
	scale 34

\end_inset


\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe1/img/resoudregoogle_windows.png
	lyxscale 30
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:resoudregoogle"

\end_inset

 Résolution du nom 
\noun on
www.google.fr
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Finalement, pour le nom 
\noun on
www.google.fr
\noun default
 (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:resoudregoogle"

\end_inset

), on peut voir que les adresses 
\noun on
www.google.fr
\noun default
 et 
\noun on
www.google.com
\noun default
 sont redirigées vers 
\noun on
www.l.google.com
\noun default
.
 Pour bien pouvoir répondre à toutes requêtes, Google utilise des plusieurs
 serveurs pour diviser la charge.
 Le serveur est du type recursif et donc utilise un cache pour répondre
 les requêtes.
 Ceci est pas forcement à jour.
 On parle alors d'une 
\emph on
réponse ne faisant pas autorité
\emph default
.
 
\end_layout

\begin_layout Subsubsection
Conclusion
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
À partir des informations que nous venons de faire, on peut constater que
 les types d'enregistrements concernés sont:
\end_layout

\begin_layout Plain Layout
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Description
A: Du à l'obtention de l'adresse IPv4
\end_layout

\begin_layout Description
CNAME: Utilisation des 
\emph on
alias
\end_layout

\begin_layout Description
SOA: Informations d'authorité de la zone DNS (serveur primaire, etc).
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Subsection
Annexe 2 - Proof of concept de la solution d'interconnexion
\end_layout

\begin_layout Subsubsection
VLAN Tagged/Untagged
\end_layout

\begin_layout Standard

\lang english
Il est important de comprendre l'usage des VLANs 
\begin_inset Quotes eld
\end_inset

tagged
\begin_inset Quotes erd
\end_inset

 et 
\begin_inset Quotes eld
\end_inset

untagged
\begin_inset Quotes erd
\end_inset

.
 Un port peut être un membre 
\begin_inset Quotes eld
\end_inset

untagged
\begin_inset Quotes erd
\end_inset

 si il ne fait partie que d'un VLAN.
 Par contre, dans le cas où un port peut correspondre à plusieurs VLANs,
 il faut qu'il soit 
\begin_inset Quotes eld
\end_inset

tagged
\begin_inset Quotes erd
\end_inset

 pour chacun des VLANs auxquels il appartient.
\end_layout

\begin_layout Standard

\lang english
Typiquement, les station finales seront marquées comme membres 
\begin_inset Quotes eld
\end_inset

untagged
\begin_inset Quotes erd
\end_inset

 d'une VLAN.
 De l'autre côté, les connexions entre switchs devraient être 
\begin_inset Quotes eld
\end_inset

tagged
\begin_inset Quotes erd
\end_inset

.
 Dû à cette configuration, il sera possible de permettre aux stations finales
 d'une même VLAN de partager les connexions avec autres VLANs.
\end_layout

\begin_layout Standard

\lang english
Les adresses des switches utilisées son 134.214.105.222 pour le switch 2 et
 134.214.105.223 pour le switch 3.
 En utilisant le modèle 3COM-4400 et l'application SUPER STACK pour gérer
 et maintenir les switches, les menus de configuration des switches se trouvent
 dans Bridge → VLAN → Display/Edit.
\end_layout

\begin_layout Subsubsection

\lang english
Configuration du switch 2
\end_layout

\begin_layout Standard

\lang english
En tenant compte de la configuration des switches, nous pouvons observer
 que le VLAN 4 est connecté au switch 1 et son port 24 est connectée au
 switch 2.
 Ainsi, pour que le switch 2 puisse y accéder, il faut qu'on marque le port
 1 du switch 2 comme 
\begin_inset Quotes eld
\end_inset

tagged
\begin_inset Quotes erd
\end_inset

, comme la figure nous montre ci-dessous.
\end_layout

\begin_layout Standard

\lang english
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center

\lang english
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe2/images/f1.png
	lyxscale 70
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout

\lang english
\begin_inset Caption

\begin_layout Plain Layout

\lang english
Configuration du switch 2
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\lang english
On observe aussi que le port 24 est marqué comme 
\begin_inset Quotes eld
\end_inset

tagged
\begin_inset Quotes erd
\end_inset

.
 C'est à cause du lien avec le switch 3.
 Ce lien permet au switch 3 d'accéder au VLAN 4.
\end_layout

\begin_layout Subsubsection

\lang english
Configuration du switch 3
\end_layout

\begin_layout Standard

\lang english
Pour la configuration du switch 3, nous avons utilisé presque la même configurat
ion que pour le switch 2.
 La différence c'est que nous avons marqué le port 6 comme 
\begin_inset Quotes eld
\end_inset

untagged
\begin_inset Quotes erd
\end_inset

 pour qu'elle soit accessible à partir d'un ordinateur du VLAN 4.
 La figure ci-dessous nous montre sa configuration.
\end_layout

\begin_layout Standard

\lang english
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center

\lang english
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe2/images/f2.png
	lyxscale 70
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout

\lang english
\begin_inset Caption

\begin_layout Plain Layout

\lang english
Configuration du switch 3
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Pour les autres ports, nous les avons marquées comme Not a member pour qu'ils
 ne soient pas accessibles sur le VLAN4 - TP.
\end_layout

\begin_layout Subsubsection
Conclusion
\end_layout

\begin_layout Standard
En utilisant cette configuration, nous nous assurons qu'on peut connecter
 un PC au port 6 du switch 3 qui peut accéder au VLAN4 - TP et que les ports
 1-5, 7-23 ne peuvent pas y accéder.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Subsection
Annexe 3 - Monitoring réseau
\end_layout

\begin_layout Subsubsection
Ipconfig Machine Windows
\end_layout

\begin_layout Standard
Machine Windows : 134.214.105.165 
\end_layout

\begin_layout Standard
Masque de sous réseau : 255.255.255.0 
\end_layout

\begin_layout Standard
Passerelle par défaut : 134.214.105.1
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/ipconfigWin.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
ipconfig Machine Windows
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Ipconfig Serveur Nagios
\end_layout

\begin_layout Standard
Serveur Nagios : 134.214.105.156 
\end_layout

\begin_layout Standard
Masque de sous réseau : 255.255.255.0
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/ifconfigNag.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
ifconfig Serveur Nagios
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On constate que les deux machines sont sur le même sous-réseau.
\end_layout

\begin_layout Subsubsection
Netstat Machine Windows
\end_layout

\begin_layout Standard

\series bold
\size large
Netstat
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/netstatWin.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
A chaque ligne correspond une connexion réseau établie entre la machine
 windows locale et une machine distante.
\end_layout

\begin_layout Standard
Les colonnes sont les suivantes : 
\end_layout

\begin_layout Description
Proto : Indique le protocole de communication utilisé.
 Celui-ci peut être : TCP, UDP, TCPv6 et UDPv6.
\end_layout

\begin_layout Description
Adresse 
\series bold
locale
\series default
 : Indique le nom ou l'adresse IP de la machine sur laquelle netstat est
 exécutée ainsi que le port de sortie de la connexion.
\end_layout

\begin_layout Description
Adresse distante : Indique le nom ou l'adresse IP de la machine distante
 avec laquelle la connexion est établie ainsi que le port d'entrée de la
 connexion.
\end_layout

\begin_layout Description
Etat : Indique l'état de la connexion.
 Celui-ci peut être :
\end_layout

\begin_deeper
\begin_layout Itemize
LISTENING -> En écoute
\end_layout

\begin_layout Itemize
ESTABLISHED -> Etablie
\end_layout

\begin_layout Itemize
TIME_WAIT -> En attente
\end_layout

\begin_layout Itemize
CLOSE_WAIT -> En attente de fermeture
\end_layout

\end_deeper
\begin_layout Standard
Ici, on peut voir différentes connexions : 
\end_layout

\begin_layout Itemize
Les quatres premières connexion sont établies entre if213-06 et la machine
 locale 
\end_layout

\begin_layout Itemize
La cinquième est en attente de fermeture entre if213-06 et la machine locale
 
\end_layout

\begin_layout Itemize
Les sixième et septième connexions sont établies avec insa-lyon.fr pour l'accès
 à servif-baie et home 
\end_layout

\begin_layout Itemize
Trois connexions sont établies et une est en attente avec le serveur nagios
 
\end_layout

\begin_layout Itemize
Les autres lignes correspondent à des connexions à des machines distantes
 en utilisant les protocoles http et https.
 
\end_layout

\begin_layout Subsection*
Netstat -a
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/netstataWin.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -a
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La commande netstat -a présente en plus des connexions de netstat, les connexion
s qui sont en écoute.
 Les connexions dont l'adresse distante est *:* sont en écoute sur le port
 de l'adresse locale.
\end_layout

\begin_layout Subsection*
Netstat -e
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/netstateWin.bmp
	width 10cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -e
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La commande netstat -e présente les informations concernant l'ensemble des
 connexions.
 On obtient ainsi le nombre d'octets, de paquets unicast et de paquets non
 monodiffusion reçus et émis.
 On peut également connaître le nombre de rejets ou d'erreurs.
 
\end_layout

\begin_layout Subsubsection*
Netstat -r
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/netstatrWin.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -r
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La commande netstat -r présente la table de routage ainsi que les itinéraires
 actifs.
 Pour chaque destination, est renseigné, son masque de sous réseau, l'adresse
 de sa passerelle, l'adresse de son interface et sa métrique.
 Certaines adresses sont remarquables : 
\end_layout

\begin_layout Standard
127.0.0.0 -> Adresse de Loopback 
\end_layout

\begin_layout Standard
134.214.105.165 -> Adresse de la machine Windows 
\end_layout

\begin_layout Standard
134.214.255.255 -> Adresse de broadcast 
\end_layout

\begin_layout Standard
192.168.0.1 -> Adresse de réseau privé
\end_layout

\begin_layout Subsubsection*
Netstat -n
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/netstatnWin.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -n
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La commande netstat -n présente les connexions actives.
 A la différence de netstat, cette commande ne présente jamais les noms
 de la machine locale et des machines distantes mais uniquement les adresse
 IP.
 Les connexions LISTENING ne sont pas présente dans cette liste puisque
 n'étant pas actives.
 
\end_layout

\begin_layout Subsubsection*
Netstat -p TCP
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/NetstatPTcp.bmp
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -p tcp
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/NetstatP.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -p udp , -p ip, -p icmp
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La commande netstat -p présente les connexions active pour le protocole
 précisé.
 On remarque ici qu'il n'y a que des connexions TCP.
\end_layout

\begin_layout Subsubsection*
Netstat -s
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/netstatsWin.bmp
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -s
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La commande netstat -s pésente les statistiques de toutes les connexions
 par protocole.
 
\end_layout

\begin_layout Subsubsection
Netstat Serveur nagios
\end_layout

\begin_layout Subsubsection*
Netstat
\end_layout

\begin_layout Standard
On éxécute les mêmes commandes sur le serveur nagios.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/Unknown.gif
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Netstat -a
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/Unknown.gif
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -a
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Netstat -e
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/Unknown.gif
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -e
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Netstat -r
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/Unknown.gif
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -r
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Netstat -n
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/NagiosNetstatN.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -n
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Netstat -p
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/NagiosNetstatP.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -p
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Netstat -s
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/Unknown.gif
	width 10cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
netstat -s
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Ping
\end_layout

\begin_layout Standard
La commande ping permet de savoir si une machine ou un serveur est accessible
 depuis une autre (machine sur laquelle est exécuter la commande).
 Cette commande envoie un 
\begin_inset Quotes eld
\end_inset

ping
\begin_inset Quotes erd
\end_inset

 à la machine distante et attend une réponse.
 Si la machine n'est pas accessible, la commande se terminera pas un échec
 suite à un timeout.
 L'exécution de la commande ping affiche le temps de réponse de la machine
 distante.
 Si la commande affiche un temps de réponse très long, c'est qu'il est possible
 qu'il y ai un problème sur le réseau.
\end_layout

\begin_layout Standard
Dans notre cas, le message suivant s'affiche sur la console :
\end_layout

\begin_layout Standard
Réponse de 134.214.105.221 : octets=32 temps=1 ms TTL=254
\end_layout

\begin_layout Standard
Dans ce cas, la machine distante à répondu et la réponse a été rapide.
 Il n'y a donc a priori pas de problème sur le réseau.
\end_layout

\begin_layout Subsubsection
Sniffer de paquet : Wireshark
\end_layout

\begin_layout Standard
Le logiciel Wireshark permet d'analyser les trames circulant sur un réseau.
 L'analyse de la requête ping permet de connaitre la composition de la trame.
 Celle-ci fait 74 octets est composé d'un entête ethernet, d'un entête ip,
 d'un entête icmp et de données.
 L'entête ethernet présente les adresses MAC de source et de destination
 de la trame et indique que le protocole ip est utilisé pour la couche supérieur
e.
 L'entête ip présente la version (ipv4), sa taille (20 octets), l'utilisation
 du protocole de controle ICMP et checksum et les adresses ip de source
 et de destination du paquet.
 L'entête ICMP contient des contrôles de validité du paquet.
 Les données sont écrites sur 32 octets.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/PingSwitchDetails.bmp
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Analyse de trame
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
MIB
\end_layout

\begin_layout Standard
MIB est une base de données regroupant les informations concernant le métériel
 sur lequel elle est installée.
 Ces informations sont utiles pour gérer un réseau.
 L'accès à la MIB se fait à l'aide du protocole snmp.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/Unknown.gif
	width 10cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
MIB
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/Unknown.gif
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
snmpget
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On constate que le serveur snmp est lancé depuis un peu plus de 7 jours.
 L'upTime permet de savoir s'il y a des coupures de courant.
\end_layout

\begin_layout Subsubsection
Traceroute
\end_layout

\begin_layout Standard
Principe de fonctionnement : Traceroute envoie des paquets UDP avec un paramètre
 TTL (Time To Live) de plus en plus grand.
 Lorsq'un routeur récupère un paquet ip, il décrémente TTL et retransmet
 le paquet.
 Lorque le TTL atteint 0, un paquet ICMP d'erreur Time To Live exceeded
 et envoyé par le routeur à la source.
 Les routeurs sont ainsi découvert de proche en proche.
 Lorsque la destination est atteinte par un paquet, la source ne recoit
 plus de paquet ICMP d'erreur mais un paquet ICMP Port Unreachable ayant
 pour adresse source, l'adresse de l'élément sondé.
\end_layout

\begin_layout Standard
La commande Traceroute permet ainsi de savoir par où passe les paquets à
 destination d'une machine distante.
 Cependant, traceroute ne montre que le chemin allant de la source à la
 destination.
 En effet, le chemin de retour peut être différent.
 Afin de déterminer la topologie du réseau, il convient donc de faire un
 traceroute depuis la machine Windows vers Iftpserv2 puis depuis Iftpserv2
 vers la machine Windows.
\end_layout

\begin_layout Standard
A noter que l'identification de la topologie peut ne pas être complète puisque
 certains routeurs peuvent ne pas répondre aux requête ICMP.
\end_layout

\begin_layout Standard

\series bold
\size large
Windows – Iftpserv2
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/tracewiniftp.bmp
	width 10cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
tracert Iftpserv2
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Iftpserv2 – Windows
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe3/images/traceiftpwin.bmp
	width 10cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
traceroute 134.214.105.165
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Topologie du réseau
\end_layout

\begin_layout Standard
Les deux traceroutes nous permettent de déduire la topologie du réseau.
 La machine Windows et iftpserv2 sont interconnecté par l'intermédiaire
 du routeur ifswitch01.insa-lyon.fr.
 Celui ci à au moins deux interfaces : 134.214.104.1 et 134.214.105.1.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/Unknown.gif
	width 15cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Topologie du reseau
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Subsection
Annexe 4 - Organisation de NAGIOS
\end_layout

\begin_layout Standard
Parmi les logiciels libre de supervision, Nagios est le plus répandu et
 également le plus suivi par la communauté de développeur.
 Nagios (anciennement appelé Netsaint) est une application permettant la
 surveillance système et réseau.
 Elle surveille les hôtes et services spécifiés, alertant lorsque les systèmes
 vont mal et quand ils vont mieux.
\end_layout

\begin_layout Subsubsection
NAGIOS
\end_layout

\begin_layout Standard
Nous allons ajouter la machine windows if213-06 , IP 134.214.105.165.
 On va modifier les fichies de configuration: en premier le fichier NSC.ini
 de NSClient++ et après Nagios.cfg et Windows.cfg sur le serveur Nagios (
 à travers une connexion SSH).
 En fait on va créer un fichier de configuration (Exemple.cfg) pour chaque
 host qu'on ajoute et va ajouter une ligne donnant le nom de ce fichier
 dans Nagios.cfg : cfg_file=/usr/local/nagios/etc/objects/Exemple.cfg
\end_layout

\begin_layout Standard

\series bold
\size large
NSC.INI
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "breaklines=true"
inline false
status open

\begin_layout Plain Layout

[modules]
\end_layout

\begin_layout Plain Layout

FileLogger.dll
\end_layout

\begin_layout Plain Layout

CheckSystem.dll
\end_layout

\begin_layout Plain Layout

CheckDisk.dll
\end_layout

\begin_layout Plain Layout

NSClientListener.dll
\end_layout

\begin_layout Plain Layout

NRPEListener.dll
\end_layout

\begin_layout Plain Layout

SysTray.dll
\end_layout

\begin_layout Plain Layout

CheckEventLog.dll
\end_layout

\begin_layout Plain Layout

CheckHelpers.dll
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

;CheckWMI.dll
\end_layout

\begin_layout Plain Layout

[Settings]
\end_layout

\begin_layout Plain Layout

;# OBFUSCATED PASSWORD
\end_layout

\begin_layout Plain Layout

; This is the same as the password option but here you can store the password
 in an obfuscated manner.
\end_layout

\begin_layout Plain Layout

; *NOTICE* obfuscation is *NOT* the same as encryption, someone with access
 to this file can still figure out the 
\end_layout

\begin_layout Plain Layout

; password.
 Its just a bit harder to do it at first glance.
\end_layout

\begin_layout Plain Layout

;obfuscated_password=Jw0KAUUdXlAAUwASDAAB
\end_layout

\begin_layout Plain Layout

;
\end_layout

\begin_layout Plain Layout

;# PASSWORD
\end_layout

\begin_layout Plain Layout

; This is the password (-s) that is required to access NSClient remotely.
 If you leave this blank everyone will be able to access the daemon remotly.
\end_layout

\begin_layout Plain Layout

password=passe
\end_layout

\begin_layout Plain Layout

;
\end_layout

\begin_layout Plain Layout

;# ALLOWED HOST ADDRESSES
\end_layout

\begin_layout Plain Layout

; This is a comma-delimited list of IP address of hosts that are allowed
 to talk to the all daemons.
\end_layout

\begin_layout Plain Layout

; If leave this blank anyone can access the deamon remotly (NSClient still
 requires a valid password).
\end_layout

\begin_layout Plain Layout

allowed_hosts=134.214.105.165,134.214.105.156
\end_layout

\begin_layout Plain Layout

[log]
\end_layout

\begin_layout Plain Layout

;# LOG DEBUG
\end_layout

\begin_layout Plain Layout

; Set to 1 if you want debug message printed in the log file (debug messages
 are always printed to stdout when run with -test)
\end_layout

\begin_layout Plain Layout

;debug=1
\end_layout

\begin_layout Plain Layout

;
\end_layout

\begin_layout Plain Layout

;# LOG FILE
\end_layout

\begin_layout Plain Layout

; The file to print log statements to
\end_layout

\begin_layout Plain Layout

file=NSC_H4312.log
\end_layout

\begin_layout Plain Layout

;
\end_layout

\begin_layout Plain Layout

;# LOG DATE MASK
\end_layout

\begin_layout Plain Layout

; The format to for the date/time part of the log entry written to file.
\end_layout

\begin_layout Plain Layout

;date_mask=%Y-%m-%d %H:%M:%S
\end_layout

\begin_layout Plain Layout

[NSClient]
\end_layout

\begin_layout Plain Layout

;# NSCLIENT PORT NUMBER
\end_layout

\begin_layout Plain Layout

; This is the port the NSClientListener.dll will listen to.
\end_layout

\begin_layout Plain Layout

port=12489
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
NAGIOS.CFG
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# Definitions for monitoring the local (Linux) host
\end_layout

\begin_layout Plain Layout

cfg_file=/usr/local/nagios/etc/objects/localhost.cfg
\end_layout

\begin_layout Plain Layout

# Definitions for monitoring a Windows machine
\end_layout

\begin_layout Plain Layout

cfg_file=/usr/local/nagios/etc/objects/windows.cfg
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
WINDOWS.CFG
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "breaklines=true"
inline false
status open

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# HOST DEFINITIONS
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

# Define a host for the Windows machine we'll be monitoring
\end_layout

\begin_layout Plain Layout

# Change the host_name, alias, and address to fit your situation
\end_layout

\begin_layout Plain Layout

define host{
\end_layout

\begin_layout Plain Layout

use windows-server ; Inherit default values from a template
\end_layout

\begin_layout Plain Layout

host_name if213-06 ; The name we're giving to this host
\end_layout

\begin_layout Plain Layout

alias Machine-test ; longer name associated with the host
\end_layout

\begin_layout Plain Layout

address 134.214.105.165 ; IP address of the host
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# HOST GROUP DEFINITIONS
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

# Define a hostgroup for Windows machines
\end_layout

\begin_layout Plain Layout

# All hosts that use the windows-server template will automatically be a
 member of this group
\end_layout

\begin_layout Plain Layout

define hostgroup{
\end_layout

\begin_layout Plain Layout

hostgroup_name windows-servers ; The name of the hostgroup
\end_layout

\begin_layout Plain Layout

alias Windows Servers ; Long name of the group
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# SERVICE DEFINITIONS
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

######################################################################
\end_layout

\begin_layout Plain Layout

# Create a service for monitoring the version of NSCLient++ that is installed
\end_layout

\begin_layout Plain Layout

# Change the host_name to match the name of the host you defined above
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name if213-06
\end_layout

\begin_layout Plain Layout

service_description NSClient++ Version
\end_layout

\begin_layout Plain Layout

check_command check_nt!CLIENTVERSION
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Create a service for monitoring the uptime of the server
\end_layout

\begin_layout Plain Layout

# Change the host_name to match the name of the host you defined above
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name if213-06
\end_layout

\begin_layout Plain Layout

service_description Uptime
\end_layout

\begin_layout Plain Layout

check_command check_nt!UPTIME
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Create a service for monitoring CPU load
\end_layout

\begin_layout Plain Layout

# Change the host_name to match the name of the host you defined above
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name if213-06
\end_layout

\begin_layout Plain Layout

service_description CPU Load
\end_layout

\begin_layout Plain Layout

check_command check_nt!CPULOAD!-l 5,80,90
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Create a service for monitoring memory usage
\end_layout

\begin_layout Plain Layout

# Change the host_name to match the name of the host you defined above
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name if213-06
\end_layout

\begin_layout Plain Layout

service_description Memory Usage
\end_layout

\begin_layout Plain Layout

check_command check_nt!MEMUSE!-w 80 -c 90
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Create a service for monitoring C:
\backslash
 disk usage
\end_layout

\begin_layout Plain Layout

# Change the host_name to match the name of the host you defined above
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name if213-06
\end_layout

\begin_layout Plain Layout

service_description C:
\backslash
 Drive Space
\end_layout

\begin_layout Plain Layout

check_command check_nt!USEDDISKSPACE!-l c -w 80 -c 90
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Create a service for monitoring the W3SVC service
\end_layout

\begin_layout Plain Layout

# Change the host_name to match the name of the host you defined above
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name if213-06
\end_layout

\begin_layout Plain Layout

service_description W3SVC
\end_layout

\begin_layout Plain Layout

check_command check_nt!SERVICESTATE!-d SHOWALL -l W3SVC
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Create a service for monitoring the Explorer.exe process
\end_layout

\begin_layout Plain Layout

# Change the host_name to match the name of the host you defined above
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name if213-06
\end_layout

\begin_layout Plain Layout

service_description Explorer
\end_layout

\begin_layout Plain Layout

check_command check_nt!PROCSTATE!-d SHOWALL -l Explorer.exe
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Résultats NAGIOS
\end_layout

\begin_layout Standard
On va commencer par monter la machine que nous avons ajouté : if213-06.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/hosts.jpg
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Statut de la machine que nous avons ajouté
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Localhost est la machine propre à Nagios.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/carte.jpg
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Carte des machines surveillées dressée par Nagios
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On peut aussi voir les details d'etat de chaque host et faire des check
 manuellement: 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/PRINT1.jpg
	lyxscale 30
	scale 67
	rotateAngle 90

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Statuts des machines observées
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On va essayer eteindre la machine if213-06, faire un check manuellement
 et regarder a partir d'une autre machine son status:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/print2.jpg
	lyxscale 20
	scale 35
	rotateAngle 90

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Statuts après extinction de if-213-06
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On peut voir que tous les services sont passé à critucal d'ou on a bien
 detecté que la machine à etait eteinte.
 
\end_layout

\begin_layout Standard
En suite on va regarder les problemes, les raports et les alerts.
 
\end_layout

\begin_layout Standard
Pour voir les problemes au moment actuel on peut cliquer sur Problems.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/problems.jpg
	lyxscale 30
	scale 55

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Problèmes
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Pat contre, si on veut avoir de statistiques au consulter l'historique,
 on peut le faire dans la partie Reports.
 On va créer un raport pour la derniere semaine et regarder l'activité de
 tous les hosts:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/report.jpg
	lyxscale 30
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Activité des machines par groupe
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On peut aussi regrader l'activité plus en detail d'un seul host.
 Pour example notre host, if213-06 pendant les dernieres 24h :
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/213 report 1 jour.jpg
	lyxscale 30
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Activité d'une machine
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
MRTG
\end_layout

\begin_layout Standard
On va monitorer le switch 134.214.105.222.
\end_layout

\begin_layout Standard
Dans un premier temps on va créer le dossier /var/www/mrtg/134.214.105.222
 
\end_layout

\begin_layout Standard

\emph on
\begin_inset listings
lstparams "language=bash"
inline false
status open

\begin_layout Plain Layout

sudo mkdir /var/www/mrtg/A.B.C.D
\end_layout

\end_inset


\end_layout

\begin_layout Standard
On ajoute la machine a superviser et donc on crée son fichier de configuration
 (un fichier de configuration/machine a superviser)
\end_layout

\begin_layout Standard

\emph on
\begin_inset listings
lstparams "language=bash"
inline false
status open

\begin_layout Plain Layout

cfgmaker --global 'WorkDir: /var/www/mrtg/134.214.105.222'
\end_layout

\begin_layout Plain Layout

		 --ifdesc=descr --global 'Language: french'
\end_layout

\begin_layout Plain Layout

		 --global 'Options[_]: bits,growright'
\end_layout

\begin_layout Plain Layout

		 public@134.214.105.222 >
\end_layout

\begin_layout Plain Layout

		 /var/www/mrtg/134.214.105.222/134.214.105.222.cfg
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Générer automatiquement les graphes: nous allons donc créer un script SHELL
 que nous lancerons en utilisant crontab.
 Ce script SHELL va lancer MRTG avec le fichier de configuration créé auparavant.
\end_layout

\begin_layout Standard

\emph on
\begin_inset listings
lstparams "language=bash"
inline false
status open

\begin_layout Plain Layout

#!/bin/sh
\end_layout

\begin_layout Plain Layout

/var/www/mrtg/134.214.105.222 env LANG=C
\end_layout

\begin_layout Plain Layout

/usr/bin/mrtg/var/www/mrtg/134.214.105.222/134.214.105.222.cfg
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Puis on lui donne les droits en exécution:
\end_layout

\begin_layout Standard

\emph on
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

chmod a+x /usr/local/bin/mrtgcron.sh
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Et enfin, on programme la crontab (crontab -l) en ajoutant la ligne suivante:
\end_layout

\begin_layout Standard

\emph on
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

*/5 * * * * /usr/local/bin/mrtgcron.sh
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
134.214.105.222.cfg
\end_layout

\begin_layout Standard
Pour pouvoir voir et afficher les graphes il faut ajouter une entrée pour
 chaque graphe dans le fichier de configuration 134.214.105.222.cfg (on ne mettra
 ici que le code pour le premier graphe, les 3 autres étant similaires).
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "breaklines=true"
inline false
status open

\begin_layout Plain Layout

# /usr/bin/cfgmaker --global 'WorkDir: /var/www/mrtg/134.214.105.222'
\end_layout

\begin_layout Plain Layout

#                   --ifdesc=descr --global 'Language: french'
\end_layout

\begin_layout Plain Layout

#                   --global 'Options[_]: bits,growright'
\end_layout

\begin_layout Plain Layout

#                   public@134.214.105.222
\end_layout

\begin_layout Plain Layout

### Global Defaults
\end_layout

\begin_layout Plain Layout

EnableIPv6: no
\end_layout

\begin_layout Plain Layout

WorkDir: /var/www/mrtg/134.214.105.222
\end_layout

\begin_layout Plain Layout

Language: french
\end_layout

\begin_layout Plain Layout

Options[_]: bits,growright
\end_layout

\begin_layout Plain Layout

### Interface 101 >> Descr: 'RMON-Port-01-on-unit-1' | Name: '' | Ip: ''
 | Eth: '' ###
\end_layout

\begin_layout Plain Layout

Target[134.214.105.222_101]: 101:public@134.214.105.222:
\end_layout

\begin_layout Plain Layout

SetEnv[134.214.105.222_101]: MRTG_INT_IP="" MRTG_INT_DESCR="RMON-Port-01-on-unit-1"
\end_layout

\begin_layout Plain Layout

MaxBytes[134.214.105.222_101]: 12500000
\end_layout

\begin_layout Plain Layout

Title[134.214.105.222_101]: RMON Port 01 on unit 1 -- switchTP222
\end_layout

\begin_layout Plain Layout

PageTop[134.214.105.222_101]: <h1>RMON Port 01 on unit 1 -- switchTP222</h1>
\end_layout

\begin_layout Plain Layout

<div id="sysdetails">
\end_layout

\begin_layout Plain Layout

<table>
\end_layout

\begin_layout Plain Layout

<tr>
\end_layout

\begin_layout Plain Layout

<td>System:</td>
\end_layout

\begin_layout Plain Layout

<td>switchTP222 in chez nous</td>
\end_layout

\begin_layout Plain Layout

</tr>
\end_layout

\begin_layout Plain Layout

<tr>
\end_layout

\begin_layout Plain Layout

<td>Maintainer:</td>
\end_layout

\begin_layout Plain Layout

<td>admin</td>
\end_layout

\begin_layout Plain Layout

</tr>
\end_layout

\begin_layout Plain Layout

<tr>
\end_layout

\begin_layout Plain Layout

<td>Description:</td>
\end_layout

\begin_layout Plain Layout

<td>RMON-Port-01-on-unit-1 RMON Port 01 on unit 1 </td>
\end_layout

\begin_layout Plain Layout

</tr>
\end_layout

\begin_layout Plain Layout

<tr>
\end_layout

\begin_layout Plain Layout

<td>ifType:</td>
\end_layout

\begin_layout Plain Layout

<td>ethernetCsmacd (6)</td>
\end_layout

\begin_layout Plain Layout

</tr>
\end_layout

\begin_layout Plain Layout

<tr>
\end_layout

\begin_layout Plain Layout

<td>ifName:</td>
\end_layout

\begin_layout Plain Layout

<td></td>
\end_layout

\begin_layout Plain Layout

</tr>
\end_layout

\begin_layout Plain Layout

<tr>
\end_layout

\begin_layout Plain Layout

<td>Max Speed:</td>
\end_layout

\begin_layout Plain Layout

<td>100.0 Mbits/s</td>
\end_layout

\begin_layout Plain Layout

</tr>
\end_layout

\begin_layout Plain Layout

</table>
\end_layout

\begin_layout Plain Layout

</div>
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\size large
Résultats MRTG
\end_layout

\begin_layout Standard
On a monitoré pendant 3 jours.
 Dans le repertoire www/mrtg/134.214.105.222 on a 16 images generées automatiquemen
t.
 On a des information par jour, semaine, mois, an pour les 4 ports choisis.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/mrtg1.jpg
	lyxscale 20
	scale 37

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Graphiques une heure après démarrage
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Après 3 jours pour le Managemet Port, 134.214.105.222 on unit 1, swtchTP222
 :
\end_layout

\begin_layout Standard
Image par jour:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/134.214.105.222_199-day.png
	scale 80

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Image par jour
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/134.214.105.222_199-week.png
	scale 80

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Image par semaine
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/134.214.105.222_199-month.png
	scale 80

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Image par mois
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/134.214.105.222_199-year.png
	scale 80

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Image par an
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
NRPE
\end_layout

\begin_layout Standard
A l'aide de NRPE nous pouvons superviser des machines Linux.
 On a par exemple ajouté la machine 134.214.105.189 (nom: h4312_linux) et on
 a changé la configuration du serveur Nagios pour qu'il utilise NRPE (nouveau
 nom: h4312_localhost).
\end_layout

\begin_layout Standard
On a repris la base NRPE qui était fournie et on l'a modifié pour pouvoir
 ajouter les deux machines.
 
\end_layout

\begin_layout Standard

\series bold
NRPE.CFG
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "breaklines=true"
inline false
status open

\begin_layout Plain Layout

# LOG FACILITY
\end_layout

\begin_layout Plain Layout

# The syslog facility that should be used for logging purposes.
\end_layout

\begin_layout Plain Layout

log_facility=daemon
\end_layout

\begin_layout Plain Layout

# PID FILE
\end_layout

\begin_layout Plain Layout

# The name of the file in which the NRPE daemon should write it's process
 ID
\end_layout

\begin_layout Plain Layout

# number.
 The file is only written if the NRPE daemon is started by the root
\end_layout

\begin_layout Plain Layout

# user and is running in standalone mode.
\end_layout

\begin_layout Plain Layout

pid_file=/var/run/nrpe.pid
\end_layout

\begin_layout Plain Layout

# COMMAND ARGUMENT PROCESSING
\end_layout

\begin_layout Plain Layout

# This option determines whether or not the NRPE daemon will allow clients
\end_layout

\begin_layout Plain Layout

# to specify arguments to commands that are executed.
 This option only works
\end_layout

\begin_layout Plain Layout

# if the daemon was configured with the --enable-command-args configure
 script
\end_layout

\begin_layout Plain Layout

# option.
 
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# *** ENABLING THIS OPTION IS A SECURITY RISK! *** 
\end_layout

\begin_layout Plain Layout

# Read the SECURITY file for information on some of the security implications
\end_layout

\begin_layout Plain Layout

# of enabling this variable.
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# Values: 0=do not allow arguments, 1=allow command arguments
\end_layout

\begin_layout Plain Layout

dont_blame_nrpe=0
\end_layout

\begin_layout Plain Layout

# DEBUGGING OPTION
\end_layout

\begin_layout Plain Layout

# This option determines whether or not debugging messages are logged to
 the
\end_layout

\begin_layout Plain Layout

# syslog facility.
\end_layout

\begin_layout Plain Layout

# Values: 0=debugging off, 1=debugging on
\end_layout

\begin_layout Plain Layout

debug=0
\end_layout

\begin_layout Plain Layout

# COMMAND TIMEOUT
\end_layout

\begin_layout Plain Layout

# This specifies the maximum number of seconds that the NRPE daemon will
\end_layout

\begin_layout Plain Layout

# allow plugins to finish executing before killing them off.
\end_layout

\begin_layout Plain Layout

command_timeout=60
\end_layout

\begin_layout Plain Layout

# CONNECTION TIMEOUT
\end_layout

\begin_layout Plain Layout

# This specifies the maximum number of seconds that the NRPE daemon will
\end_layout

\begin_layout Plain Layout

# wait for a connection to be established before exiting.
 This is sometimes
\end_layout

\begin_layout Plain Layout

# seen where a network problem stops the SSL being established even though
\end_layout

\begin_layout Plain Layout

# all network sessions are connected.
 This causes the nrpe daemons to
\end_layout

\begin_layout Plain Layout

# accumulate, eating system resources.
 Do not set this too low.
\end_layout

\begin_layout Plain Layout

connection_timeout=300
\end_layout

\begin_layout Plain Layout

# COMMAND DEFINITIONS
\end_layout

\begin_layout Plain Layout

# Command definitions that this daemon will run.
 Definitions
\end_layout

\begin_layout Plain Layout

# are in the following format:
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# command[<command_name>]=<command_line>
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# When the daemon receives a request to return the results of <command_name>
\end_layout

\begin_layout Plain Layout

# it will execute the command specified by the <command_line> argument.
\end_layout

\begin_layout Plain Layout

#
\end_layout

\begin_layout Plain Layout

# Unlike Nagios, the command line cannot contain macros - it must be
\end_layout

\begin_layout Plain Layout

# typed exactly as it should be executed.
\end_layout

\begin_layout Plain Layout

command[check_users]=/usr/local/nagios/libexec/check_users -w 5 -c 10
\end_layout

\begin_layout Plain Layout

command[check_load]=/usr/local/nagios/libexec/check_load -w 15,10,5 -c 30,25,20
\end_layout

\begin_layout Plain Layout

command[check_hda1]=/usr/local/nagios/libexec/check_disk -w 20% -c 10% -p
 /dev/sda1
\end_layout

\begin_layout Plain Layout

command[check_zombie_procs]=/usr/local/nagios/libexec/check_procs -w 5 -c
 10 -s Z
\end_layout

\begin_layout Plain Layout

command[check_total_procs]=/usr/local/nagios/libexec/check_procs -w 150
 -c 200 
\end_layout

\begin_layout Plain Layout

command[check_hdd]=/usr/local/nagios/libexec/check_disk -w 20 -c 10 -p /
\end_layout

\begin_layout Plain Layout

command[check_swaphdd]=/usr/local/nagios/libexec/check_swap -w 20 -c 10
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
h4312_linux.cfg
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "breaklines=true"
inline false
status open

\begin_layout Plain Layout

On a ajouter les services demandés (gestion des users, zombies,
\end_layout

\begin_layout Plain Layout

processus et charge CPU) pour monitorer la machine.
 Le code pour le
\end_layout

\begin_layout Plain Layout

serveur Nagios est similaire a celui-ci et donc on va pas le mettre
\end_layout

\begin_layout Plain Layout

dans le compte-rendu.
\end_layout

\begin_layout Plain Layout

################################################
\end_layout

\begin_layout Plain Layout

# Monitoring teacher's linux avec NRPE 
\end_layout

\begin_layout Plain Layout

################################################
\end_layout

\begin_layout Plain Layout

#########################
\end_layout

\begin_layout Plain Layout

## HOST
\end_layout

\begin_layout Plain Layout

#########################
\end_layout

\begin_layout Plain Layout

define host {
\end_layout

\begin_layout Plain Layout

use linux-server
\end_layout

\begin_layout Plain Layout

host_name h4312_linux
\end_layout

\begin_layout Plain Layout

alias remote Linux
\end_layout

\begin_layout Plain Layout

address 134.214.105.189
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

#########################
\end_layout

\begin_layout Plain Layout

## SERVICES
\end_layout

\begin_layout Plain Layout

#########################
\end_layout

\begin_layout Plain Layout

# Charge CPU
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name h4312_linux
\end_layout

\begin_layout Plain Layout

service_description CPU Load
\end_layout

\begin_layout Plain Layout

check_command check_nrpe!check_load
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Users
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name h4312_linux
\end_layout

\begin_layout Plain Layout

service_description Users
\end_layout

\begin_layout Plain Layout

check_command check_nrpe!check_users
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Zombies
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name h4312_linux
\end_layout

\begin_layout Plain Layout

service_description Zombies
\end_layout

\begin_layout Plain Layout

check_command check_nrpe!check_zombie_procs
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

# Processus
\end_layout

\begin_layout Plain Layout

define service{
\end_layout

\begin_layout Plain Layout

use generic-service
\end_layout

\begin_layout Plain Layout

host_name h4312_linux
\end_layout

\begin_layout Plain Layout

service_description Processus
\end_layout

\begin_layout Plain Layout

check_command check_nrpe!check_total_procs
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
NAGIOS.CFG
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# Definitions for monitoring the local (Linux) host
\end_layout

\begin_layout Plain Layout

cfg_file=/usr/local/nagios/etc/objects/h4312_localhost.cfg
\end_layout

\begin_layout Plain Layout

# Definitions for monitoring a Windows machine
\end_layout

\begin_layout Plain Layout

cfg_file=/usr/local/nagios/etc/objects/windows.cfg
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Résultats NRPE
\end_layout

\begin_layout Standard
On a ajouté la machine linux monitorée a l'aide de NRPE:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/map_nrpe.PNG
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Machines monitorées par noagios
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Le client sur la machine if213-06 est éteint.
 On peut visualiser pour la machine Linux le status des parametres qu'on
 a ajouté :
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename /home/billy/programation/github/adminReseau/annexe4/imagini/status_nrpe.PNG
	lyxscale 30
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Statuts des paramètres observés
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Analyse critique de l'Installation/Utilisation de Nagios
\end_layout

\begin_layout Standard
Le gros avantage de Nagios est le fait que c'est un outil qui dispose d'une
 documentation très fournie.
 Il est très modulable et flexible grâce à son fonctionnement par fichier
 de configuration.
 Mais ce qui fait sa force fait aussi sa faiblesse car ces fichiers de configura
tions multiples peuvent poser des problème s'il y en a beaucoup, particulièremen
t lorsqu'on n'est pas habitué à cette méthode de fonctionnement.
 Cela nécessite une bonne organisation pour s'y retrouver mais lorsqu'on
 est bien organisé, on peut facilement automatiser le traitement des information
s grâce à des scripts.
 
\end_layout

\begin_layout Standard
Son installation n'est pas très compliquée.
 C'est un simple système client-serveur.
 On installe le serveur puis les clients puis il faut configurer.
 Il faut configurer les clients pour qu'ils acceptent les connexions et
 les échanges d'information.
 Il faut configurer le serveur pour chaque client que l'on ajoute.
 Il faut savoir que l'on peut utiliser un seul fichier de configuration
 pour tout le programme mais ce n'est pas conseillé pour une raison de lisibilit
é.
 Il faut donc bien réfléchir à l'arborescence des fichiers dès le départ,
 ce qui peut être difficile lorsque l'on n'a pas l'habitude.
\end_layout

\begin_layout Standard
Son utilisation par l'interface web est assez intuitive et permet une navigation
 rapide entre les différents services associés aux machines monitorées.
 La maintenance (ajout de nouvelles machines, nouveau services, ...) dépend
 beaucoup de la façon dont ont été créé les fichiers de configuration au
 départ.
 Cela peut donc varier entre très simple, voire automatisé et très compliqué.
 Pour nous, une fois que nous avons compris comment tout s'agençait, cela
 a été plutôt facile.
\end_layout

\begin_layout Standard
C'est un outil qui permet de regrouper les informations sur toutes les machines
 surveillées, ce qui est très pratique mais il ne fait que du monitoring
 système et ne permet pas le monitoring réseau.
 Il ne reconnaît pas non plus la topologie réseau, ce qui peut poser quelques
 problèmes, notamment lorsque les machines sont équipées d'adresses IP dynamique
s (les fichiers de configurations ne peuvent pas prendre en compte ce type
 de cas).
 Ce pourrait être un outil très puissant couplé avec une application de
 monitoring réseau.
\end_layout

\end_body
\end_document
